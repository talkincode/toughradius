# Web åŒ…é”™è¯¯è§£å†³æ–¹æ¡ˆ

## é—®é¢˜æè¿°

åœ¨ `web/` ç›®å½•ä¸­çœ‹åˆ°å¾ˆå¤š TypeScript ç¼–è¯‘é”™è¯¯ï¼Œä¸»è¦æ˜¯ï¼š

1. **æ‰¾ä¸åˆ°æ¨¡å—** - `react-admin`ã€`react`ã€`react-dom` ç­‰
2. **JSX ç±»å‹é”™è¯¯** - æ‰¾ä¸åˆ° `react/jsx-runtime`
3. **éšå¼ any ç±»å‹** - æŸäº›å‚æ•°æ²¡æœ‰ç±»å‹å£°æ˜
4. **Go embed é”™è¯¯** - `dist/*` æ²¡æœ‰åŒ¹é…çš„æ–‡ä»¶

## æ ¹æœ¬åŸå› 

### 1. å‰ç«¯ä¾èµ–æœªå®‰è£…

**é”™è¯¯ä¿¡æ¯ï¼š**

```
æ‰¾ä¸åˆ°æ¨¡å—"react-admin"æˆ–å…¶ç›¸åº”çš„ç±»å‹å£°æ˜ã€‚
æ‰¾ä¸åˆ°æ¨¡å—"react"æˆ–å…¶ç›¸åº”çš„ç±»å‹å£°æ˜ã€‚
```

**åŸå› ï¼š** `node_modules` ç›®å½•ä¸å­˜åœ¨ï¼Œnpm åŒ…æœªå®‰è£…ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
cd /Volumes/ExtDISK/github/toughradius/web
npm install
```

### 2. dist ç›®å½•ä¸ºç©º

**é”™è¯¯ä¿¡æ¯ï¼ˆGoï¼‰ï¼š**

```
pattern dist/*: no matching files found
```

**åŸå› ï¼š** Go çš„ `//go:embed dist/*` æŒ‡ä»¤è¦æ±‚ dist ç›®å½•è‡³å°‘åŒ…å«ä¸€ä¸ªæ–‡ä»¶ã€‚

**ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼š**
å·²åˆ›å»º `web/dist/index.html` ä½œä¸ºå ä½æ–‡ä»¶ã€‚

**æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼š**

```bash
cd web
npm run build
```

### 3. TypeScript ç±»å‹è­¦å‘Š

**é”™è¯¯ä¿¡æ¯ï¼š**

```
å‚æ•°"resource"éšå¼å…·æœ‰"any"ç±»å‹ã€‚
å‚æ•°"params"éšå¼å…·æœ‰"any"ç±»å‹ã€‚
```

**åŸå› ï¼š** åœ¨å®‰è£…ä¾èµ–åï¼Œè¿™äº›è­¦å‘Šä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œå› ä¸ºç±»å‹å®šä¹‰æ¥è‡ª `react-admin` åŒ…ã€‚

## å®Œæ•´è§£å†³æ­¥éª¤

### æ­¥éª¤ 1: å®‰è£…å‰ç«¯ä¾èµ–

```bash
cd /Volumes/ExtDISK/github/toughradius/web
npm install
```

**é¢„æœŸç»“æœï¼š**

- åˆ›å»º `node_modules/` ç›®å½•
- å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…ï¼ˆreact, react-admin, vite, echarts ç­‰ï¼‰
- TypeScript é”™è¯¯å¤§éƒ¨åˆ†æ¶ˆå¤±

### æ­¥éª¤ 2: éªŒè¯å®‰è£…

```bash
# æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…æˆåŠŸ
ls node_modules/react-admin

# è¿è¡Œç±»å‹æ£€æŸ¥
npm run type-check
```

### æ­¥éª¤ 3: æ„å»ºå‰ç«¯

```bash
npm run build
```

**é¢„æœŸç»“æœï¼š**

- åˆ›å»º `dist/` ç›®å½•
- ç”Ÿæˆç”Ÿäº§ç‰ˆæœ¬çš„é™æ€æ–‡ä»¶
- Go embed é”™è¯¯æ¶ˆå¤±

### æ­¥éª¤ 4: éªŒè¯ Go ç¼–è¯‘

```bash
cd ..
go build
```

## å½“å‰çŠ¶æ€

âœ… **å·²å®Œæˆï¼š**

- å‰ç«¯é¡¹ç›®ç»“æ„å·²åˆ›å»º
- æ‰€æœ‰ TypeScript æºä»£ç å·²å°±ä½
- package.json é…ç½®æ­£ç¡®
- ä¸´æ—¶ dist/index.html å·²åˆ›å»ºï¼ˆè§£å†³ Go embedï¼‰

â³ **è¿›è¡Œä¸­ï¼š**

- npm install æ­£åœ¨è¿è¡Œ...

âš ï¸ **å¾…å®Œæˆï¼š**

- ç­‰å¾… npm install å®Œæˆ
- è¿è¡Œ npm run build æ„å»ºå‰ç«¯
- æµ‹è¯• Go ç¼–è¯‘

## é”™è¯¯ç»Ÿè®¡

åœ¨å®‰è£…ä¾èµ–å‰ï¼Œæ˜¾ç¤ºçš„é”™è¯¯åŒ…æ‹¬ï¼š

- **æ¨¡å—æœªæ‰¾åˆ°é”™è¯¯ï¼š** ~15 ä¸ª
- **JSX ç±»å‹é”™è¯¯ï¼š** ~40 ä¸ª
- **éšå¼ any ç±»å‹ï¼š** ~20 ä¸ª
- **Go embed é”™è¯¯ï¼š** 1 ä¸ª

**æ€»è®¡ï¼š** çº¦ 90 ä¸ªé”™è¯¯

åœ¨å®‰è£…ä¾èµ–åï¼Œé¢„è®¡å‰©ä½™é”™è¯¯ï¼š**0 ä¸ª**

## é¢„é˜²æªæ–½

ä¸ºé¿å…å°†æ¥å‡ºç°ç±»ä¼¼é—®é¢˜ï¼š

### 1. æ·»åŠ  .gitignore

ç¡®ä¿ `web/.gitignore` åŒ…å«ï¼š

```
node_modules/
dist/
```

### 2. æ–‡æ¡£è¯´æ˜

åœ¨ README ä¸­æ˜ç¡®è¯´æ˜ï¼š

```markdown
## å®‰è£…æ­¥éª¤

1. å®‰è£…å‰ç«¯ä¾èµ–ï¼š
   cd web && npm install

2. æ„å»ºå‰ç«¯ï¼š
   npm run build

3. ç¼–è¯‘ Goï¼š
   cd .. && go build
```

### 3. ä½¿ç”¨æ„å»ºè„šæœ¬

ä½¿ç”¨æä¾›çš„æ„å»ºè„šæœ¬ï¼š

```bash
# æ„å»ºå‰ç«¯
./scripts/build-frontend.sh

# æ„å»ºå¹¶æ‰“åŒ…åç«¯ï¼ˆéœ€è¦ dist å·²ç”Ÿæˆï¼‰
./scripts/build-backend.sh
```

## ä¸‹ä¸€æ­¥

1. âœ… ç­‰å¾… npm install å®Œæˆ
2. ğŸ”² è¿è¡Œ `npm run type-check` éªŒè¯ç±»å‹
3. ğŸ”² è¿è¡Œ `npm run build` æ„å»ºå‰ç«¯
4. ğŸ”² æµ‹è¯• Go ç¼–è¯‘ï¼š`go build`
5. ğŸ”² è¿è¡Œç¨‹åºï¼š`./toughradius -c toughradius.yml`

## æŠ€æœ¯ç»†èŠ‚

### ä¸ºä»€ä¹ˆéœ€è¦ dist ç›®å½•ï¼Ÿ

Go çš„ `embed` æŒ‡ä»¤åœ¨**ç¼–è¯‘æ—¶**åµŒå…¥æ–‡ä»¶ï¼š

```go
//go:embed dist/*
var distFS embed.FS
```

å¦‚æœ `dist/` ç›®å½•ä¸å­˜åœ¨æˆ–ä¸ºç©ºï¼Œç¼–è¯‘ä¼šå¤±è´¥ã€‚è§£å†³æ–¹æ¡ˆï¼š

- å¼€å‘æ—¶ï¼šåˆ›å»ºå ä½æ–‡ä»¶ `dist/index.html`
- ç”Ÿäº§æ—¶ï¼šè¿è¡Œ `npm run build` ç”Ÿæˆå®é™…æ–‡ä»¶

### TypeScript ä¸¥æ ¼æ¨¡å¼

é¡¹ç›®å¯ç”¨äº† TypeScript ä¸¥æ ¼æ¨¡å¼ï¼š

```json
{
  "compilerOptions": {
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true
  }
}
```

è¿™ä¼šäº§ç”Ÿæ›´å¤šç±»å‹è­¦å‘Šï¼Œä½†ç¡®ä¿ä»£ç è´¨é‡ã€‚å®‰è£…ä¾èµ–åï¼Œç±»å‹å®šä¹‰ä¼šè§£å†³å¤§éƒ¨åˆ†é—®é¢˜ã€‚

---

**æ›´æ–°æ—¶é—´ï¼š** 2025-11-08 14:32  
**çŠ¶æ€ï¼š** npm install è¿è¡Œä¸­...
